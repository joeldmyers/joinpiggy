function getBrowser(){var o,e=navigator.userAgent,i=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[]
return/trident/i.test(i[1])?(o=/\brv[ :]+(\d+)/g.exec(e)||[],"IE"):"Chrome"===i[1]&&(o=e.match(/\bOPR\/(\d+)/),null!=o)?"Opera "+o[1]:(i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(o=e.match(/version\/(\d+)/i))&&i.splice(1,1,o[1]),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"mobile":(str=i.join(" "),str=str.split(" ")[0],str))}function downloadApp(){if($("#signup-group-modal").modal("hide"),$("#signup-modal").modal("hide"),$("#login-modal").modal("hide"),$("#app-coming-soon-modal").modal("hide"),"mobile"==getBrowser())$("#app-coming-soon-modal").modal({backdrop:"static"}).modal("show")
else{var o=document.URL,e=new RegExp(".*?\\/.*?\\/.*?(\\/)(i)(d)(\\/)(\\d+)(\\/)",["i"]),i=e.exec(o)
null!=i&&console.log("on school page -> set cookie for id = "+i[5]),$("#app-info-modal").modal({backdrop:"static"}).modal("show")
var t=new Date
switch(t.setDate(t.getDate()),t.setMinutes(t.getMinutes()-60),getBrowser()){case"Chrome":chrome.webstore.install($('link[rel="chrome-webstore-item"]').attr("href"),function(){if($.cookie("open_url")){var o=$.cookie("open_url")
$.removeCookie("open_url",{expires:t,path:"/",domain:"."+document.location.host}),document.location=o}},function(){if($.cookie("open_url")){var o=$.cookie("open_url")
$.removeCookie("open_url",{expires:t,path:"/",domain:"."+document.location.host}),document.location=o}}),setTimeout(function(){$("#app-info-modal").modal("hide")},5e3)
break
case"Firefox":var n="http://d127ctesy9lxrv.cloudfront.net/appfiles/Piggy.xpi"
if($.cookie("open_url")){window.open(n,"_self")
var a=$.cookie("open_url")
$.removeCookie("open_url",{expires:t,path:"/",domain:"."+document.location.host}),setTimeout(function(){document.location=a},3500)}else document.location=n
break
case"Safari":var n="http://d127ctesy9lxrv.cloudfront.net/appfiles/Piggy.safariextz"
if($.cookie("open_url")){window.open(n,"_self")
var a=$.cookie("open_url")
$.removeCookie("open_url",{expires:t,path:"/",domain:"."+document.location.host}),setTimeout(function(){document.location=a},3500)}else document.location=n
break
case"IE":var n="http://d127ctesy9lxrv.cloudfront.net/appfiles/Piggy.exe"
if($.cookie("open_url")){window.open(n,"_self")
var a=$.cookie("open_url")
$.removeCookie("open_url",{expires:t,path:"/",domain:"."+document.location.host}),setTimeout(function(){document.location=a},3500)}else document.location=n}}}