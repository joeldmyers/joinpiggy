function getBrowser(){var e,o=navigator.userAgent,i=o.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[]
return/trident/i.test(i[1])?(e=/\brv[ :]+(\d+)/g.exec(o)||[],"IE"):"Chrome"===i[1]&&(e=o.match(/\bOPR\/(\d+)/),null!=e)?"Opera "+e[1]:(i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=o.match(/version\/(\d+)/i))&&i.splice(1,1,e[1]),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"mobile":(str=i.join(" "),str=str.split(" ")[0],str))}function downloadApp(e){var o=getBrowser()
if(e.showModals){switch(o){case"mobile":break
case"Chrome":$("#app-info-modal").css("padding-top","300px"),$(".chrome-upper").show(),$("#app-info-modal .modal-dialog").hide()
break
case"Firefox":$(".install-upper").show(),$("#firefox-steps").show()
break
case"Safari":$(".install-upper-safari").show(),$("#safari-steps").show(),-1!=navigator.appVersion.indexOf("Win")&&$("#safari-inst").html('Click "Install"')
break
case"IE":$(".install-lower").show(),$("#ie-steps").show()}$("#app-info-modal").modal({backdrop:"static"}).modal("show"),("Firefox"==o||"IE"==o)&&e.skipUrl&&e.skipTimeout&&setTimeout(function(){cofundAppSkip()},1e3*e.skipTimeout)}if("mobile"==o)cofundApppSkip()
else{var i=document.URL,a=new RegExp(".*?\\/.*?\\/.*?(\\/)(i)(d)(\\/)(\\d+)(\\/)",["i"]),p=a.exec(i)
null!=p&&console.log("on school page -> set cookie for id = "+p[5])
var s
switch(o){case"Chrome":open("https://www.joinpiggy.com/lp/p3","_blank")
break
case"Firefox":s="https://www.joinpiggy.com/appfiles/Piggy.xpi",window.open(s,"_self")
break
case"Safari":s="https://www.joinpiggy.com/appfiles/Piggy.safariextz",window.open(s,"_blank")
break
case"IE":s="https://www.joinpiggy.com/appfiles/Piggy.exe",window.open(s,"_self")}}}function cofundAppInstall(e){if(cofundAppOptions=e,!e.email||!e.ref3||!e.ref4)return!1
e.skipUrl||(e.skipUrl="http://carbontrackr.com/?E=01DiGwMmAsCAlQROcsOUtw%3d%3d&s2="+(e.ref5?e.ref5:"lp-unset")+"&s3=lp-ai1")
var o=getBrowser(),i="",a=""
e.nd=Math.floor(1e4*Math.random())
for(var p in e)"skipUrl"==p||"skipTimeout"==p?a=""==a?a+"?"+p+"="+escape(e[p]):a+"&"+p+"="+escape(e[p]):i=i+"&"+p+"="+encodeURIComponent(e[p])
switch(o){case"Chrome":case"Safari":var s="http://www.joinpiggy.com/autosignup?email="+e.email+"&go=lp/p3"+encodeURIComponent(a)+i
open(s,"_self")
break
case"Firefox":case"IE":var s="http://www.joinpiggy.com/autosignup?image=1"+i,n=new Image
n.onload=function(){downloadApp(e)},n.src=s,n.width="1px",n.height="1px"
break
case"mobile":if(e.skipUrl){var s="http://www.joinpiggy.com/autosignup?email="+e.email+"&go="+encodeURIComponent(e.skipUrl)
open(s,"_self")}}}function cofundAppSkip(){open(cofundAppOptions.skipUrl,"_self")}var cofundAppOptions
